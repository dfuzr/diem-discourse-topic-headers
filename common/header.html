<script type="text/discourse-plugin" version="0.8">
  const container = Discourse.__container__;
  const { h } = require('virtual-dom');


  // A mapping of the category ID to the topic metadata
  const categoryMap = {
    5: {
      name: 'Event Calendar',
      hasNetworkHeader: true,
      description: 'Calendar: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt'
    },
    6: {
      name: 'Milestones',
      hasNetworkHeader: true,
      description: 'Milestones: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt'
    },
    8: {
      name: 'Association Updates',
      hasNetworkHeader: true,
      description: 'Updates: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt'
    },
    9: {
      name: 'Member Resourcing',
      hasNetworkHeader: true,
      description: 'Member resourcing: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt'
    },
  };

  api.registerConnectorClass('topic-above-post-stream', 'libra-post-header', {
    setupComponent(args, component) {
      const data = categoryMap[args.model.category.id];
      if (data) {
        component.set('hasNetworkHeader', data.hasNetworkHeader)
      }
    }
  });

  api.registerConnectorClass('topic-title', 'libra-post-topic', {
    setupComponent(args, component) {
      const data = categoryMap[args.model.category.id];
      if (data) {
        console.log('Adding Event Calendar')
        component.set('headerDescription', data.description)
      }
    }
  });

  api.registerConnectorClass('below-site-header', 'libra-category-header', {
    setupComponent(args, component) {
      const path = window.location.pathname;
      let category;
      console.log(path)
      const controller = container.lookup('controller:navigation/category');
      console.log(controller)
      category = controller.get("category");
      console.log(category)
      console.log('Yarrrgs', args, component, arguments)
      const data = categoryMap[category.id];
      if (data) {
        component.set('categoryObj', category);
        component.set('categoryHeader', data.hasNetworkHeader);
        component.set('headerDescription', data.description)
      }
    }
  });

</script>

<script
  type="text/x-handlebars"
  data-template-name="/connectors/topic-above-post-stream/libra-post-header"
>
  {{#if hasNetworkHeader}}
    <div class="above-topic-image-wrapper">
      <img class="above-topic-image" src="https://libra.org/wp-content/uploads/2019/10/network@2x.png" />
    </div>
  {{/if}}
</script>

<script
  type="text/x-handlebars"
  data-template-name="/connectors/topic-title/libra-post-topic"
>
  {{#if headerDescription}}
   <div class="post-title-description">
     {{ headerDescription }}
   </div>
  {{/if}}
</script>

<script
  type="text/x-handlebars"
  data-template-name="/connectors/below-site-header/libra-category-header"
>
  {{#if categoryHeader}}
    <div class="wrap">
      <div class="hero">
        <div class="above-topic-image-wrapper">
          <img class="above-topic-image" src="https://libra.org/wp-content/uploads/2019/10/network@2x.png" />
        </div>
        <h1>{{ categoryObj.name }}</h1>
        <div class="post-title-description">
          {{ headerDescription }}
        </div>
      </div>
    </div>
  {{/if}}
</script>
